# 0x01 分析程序

首先使用x64dbg打开考核文件

![打开文件](.\打开文件.png)

之后我们直接运行到程序的进入点

![程序进入点](.\程序进入点.png)

搜索字符串

![搜索字符串](.\搜索字符串.png)双击跳转到需要我们输出的字符串所在地

![字符串所在地](.\字符串所在地.png)

我观察以及对程序多次运行发现，箭头所指代码代表程序载入输出的字符串

![1](.\1.png)

接着我们向上滑动观察，发现程序破解关键点

![关键点](.\关键点.png)

根据代码

> 00000001400012A9 | 48:83F8 08               | cmp rax,8                               |

我们需要知道rax所代表什么，所以我们在此处下一个断点

之后我们打开程序界面，随便输入一些字符，运行

![运行程序1](.\运行程序1.png)

根据rax的值我猜测rax代表我们输入字符串的长度，再测试一次

![测试1](.\测试1.png)

所以我们确定了rax就代表我们输入字符串的长度

# 0x02 破解程序

## Level-荧

对程序进行打补丁，使得输入任何**长度小于20个字符**的输入都能让程序输出“Chongqing No Water No Electric No Network University"

通过之前分析程序所得关键点代码

> 00000001400012A9 | 48:83F8 08               | cmp rax,8                               |
> 00000001400012AD | 0F85 98020000            | jne wintertask.14000154B                |

我发现只要我们输入的字符串长度不为8，程序就会跳转到载入输出字符为”Nice!"

所以我们要想达到我们的目标就需要对文件进行打补丁，如下

> 00000001400012A9 | 48:83F8 15               | cmp rax,15                              |
> 00000001400012AD | 0F82 6D020000            | jb wintertask.140001520                 |

其中跳转地址140001520地址处所代表的是将输出载入为我们的目标输出

之后我们回到目标字符串附近分析，发现另一个关键点

![关键点2](.\关键点2.png)

> 0000000140001543 | 81F9 30E517F6            | cmp ecx,F617E530                        |
> 0000000140001549 | 74 07                    | je wintertask.140001552                 |
> 000000014000154B | 48:8D15 EE1E0000         | lea rdx,qword ptr ds:[140003440]        | 0000000140003440:"Nice!"
> 0000000140001552 | 48:8B0D AF1B0000         | mov rcx,qword ptr ds:[<&?cout@std@@3V?$ |

经过几次运行程序测试后我推测

> 0000000140001552 | 48:8B0D AF1B0000         | mov rcx,qword ptr ds:[<&?cout@std@@3V?$ |

这是让程序输出字符串的代码，所以我对程序打了补丁，结果如下

> 0000000140001543 | 81F9 30E517F6            | cmp ecx,F617E530                        |
> 0000000140001549 | EB 07                    | jmp wintertask.140001552                |
> 000000014000154B | 48:8D15 EE1E0000         | lea rdx,qword ptr ds:[140003440]        | 0000000140003440:"Nice!"
> 0000000140001552 | 48:8B0D AF1B0000         | mov rcx,qword ptr ds:[<&?cout@std@@3V?$ |

之后对程序进行测试

字符串长度小于等于20

![1](.\测试2.png)

![2](.\测试3.png)

字符串长度大于20

![3](.\测试4.png)

程序破解成功！